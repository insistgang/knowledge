# 智能金融产品推荐系统 V1.0
## 软件设计说明书

---

## 文档信息

| 项目 | 内容 |
|------|------|
| 软件名称 | 智能金融产品推荐系统 |
| 软件版本 | V1.0 |
| 文档版本 | V1.0 |
| 编写日期 | 2024年12月15日 |
| 编写单位 | 智能金融产品推荐系统开发团队 |

---

## 目录

1. [引言](#1-引言)
2. [系统概述](#2-系统概述)
3. [系统设计原则](#3-系统设计原则)
4. [系统架构设计](#4-系统架构设计)
5. [功能模块设计](#5-功能模块设计)
6. [数据库设计](#6-数据库设计)
7. [接口设计](#7-接口设计)
8. [算法设计](#8-算法设计)
9. [安全设计](#9-安全设计)
10. [测试设计](#10-测试设计)

---

## 1. 引言

### 1.1 编写目的

本软件设计说明书详细描述了"智能金融产品推荐系统"的整体设计方案，包括系统架构、功能模块、数据结构、接口规范等内容，为软件开发、测试、维护提供技术依据。

### 1.2 项目背景

随着银行业务的数字化发展，银行拥有海量的客户数据，但如何将数据转化为营销价值是当前面临的重要挑战。本项目针对银行社保卡客户的精准营销场景，开发一套智能化的金融产品推荐系统。

### 1.3 术语定义

| 术语 | 定义 |
|------|------|
| 客户画像 | 基于客户基本信息、行为数据等构建的客户特征模型 |
| 产品推荐 | 根据客户特征智能匹配适合的金融产品 |
| 两步推荐 | 初步推荐和基于反馈的优化推荐两个阶段 |
| 正样本 | 客户表示感兴趣的产品反馈 |
| 负样本 | 客户表示不感兴趣或已拥有的产品反馈 |
| 匹配分数 | 产品与客户匹配程度的量化指标（0-100） |

### 1.4 参考资料

1. 《软件工程概论》
2. 《机器学习算法原理与应用》
3. RESTful API设计规范
4. HTML5/CSS3/JavaScript开发文档

---

## 2. 系统概述

### 2.1 系统目标

本系统旨在为银行提供一套智能化的金融产品推荐解决方案，实现以下目标：

1. **精准推荐**：基于客户画像进行个性化产品推荐
2. **持续优化**：通过客户反馈不断优化推荐准确性
3. **数据驱动**：利用客户历史行为数据挖掘营销机会
4. **产品管理**：支持新产品分析和冲突检测

### 2.2 应用范围

- 银行个人客户营销
- 社保卡客户产品转化
- 客户生命周期管理
- 新产品市场推广

### 2.3 主要功能

| 功能模块 | 功能描述 |
|----------|----------|
| 客户管理 | 客户信息查询、画像分析 |
| 产品推荐 | 智能推荐、反馈收集、策略优化 |
| 事件分析 | 历史事件查询、行为模式识别 |
| 新产品分析 | 产品冲突检测、目标客户匹配 |
| 数据统计 | 推荐效果统计、准确率分析 |

---

## 3. 系统设计原则

### 3.1 实用性原则

系统功能紧贴银行业务实际需求，解决客户营销中的痛点问题。

### 3.2 可扩展性原则

采用模块化设计，便于后续功能扩展和系统升级。

### 3.3 安全性原则

保护客户隐私数据，确保数据传输和存储安全。

### 3.4 易用性原则

界面简洁直观，操作便捷，降低用户学习成本。

---

## 4. 系统架构设计

### 4.1 总体架构

系统采用前后端分离的B/S架构，由以下层次组成：

```
┌─────────────────────────────────────────────────────────┐
│                      表现层                              │
│              (HTML5 + CSS3 + JavaScript)                 │
└─────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────┐
│                      业务层                              │
│                   (Node.js + Express)                    │
└─────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────┐
│                      算法层                              │
│                  (Python + scikit-learn)                 │
└─────────────────────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────┐
│                      数据层                              │
│              (CSV文件 + 内存存储)                         │
└─────────────────────────────────────────────────────────┘
```

### 4.2 技术架构

**前端技术栈：**
- HTML5：页面结构
- CSS3：样式设计
- JavaScript (ES6+)：交互逻辑
- Bootstrap 5.1.3：UI框架
- Font Awesome 6.0.0：图标库

**后端技术栈：**
- Node.js 18+：运行环境
- Express.js 5.1.0：Web框架
- CORS：跨域支持
- csv-parser：CSV文件解析

**算法技术栈：**
- Python 3.8+：算法实现语言
- pandas：数据处理
- numpy：数值计算
- scikit-learn：机器学习算法
- imbalanced-learn：不平衡数据处理

### 4.3 部署架构

系统支持单机部署和分布式部署两种模式：

**单机部署：**
- 所有组件运行在同一台服务器上
- 适用于小型机构和演示场景

**分布式部署：**
- 前端部署在Web服务器
- 后端API服务器独立部署
- 算法引擎独立部署
- 适用于生产环境和大规模应用

---

## 5. 功能模块设计

### 5.1 客户管理模块

**功能描述：**
- 客户基本信息查询
- 客户画像分析与展示
- 风险偏好评估
- 投资能力评估

**处理流程：**
1. 接收客户ID查询请求
2. 从数据源获取客户信息
3. 分析客户风险画像
4. 生成客户洞察报告
5. 返回完整客户信息

**输入输出：**
- 输入：客户ID
- 输出：客户基本信息、风险画像、投资建议

### 5.2 产品推荐模块

**功能描述：**
- 基于客户特征生成产品推荐
- 计算产品匹配分数
- 收集客户反馈
- 基于反馈优化推荐策略

**推荐算法流程：**
1. 获取客户基本信息和风险画像
2. 根据客户特征筛选符合条件的产品
3. 计算每个产品的匹配分数
4. 按分数排序返回Top-N推荐

**匹配分数计算公式：**
```
匹配分数 = 基础分(50) + 年龄适配分 + 风险偏好分 + 教育背景分 + 资产规模分
```

### 5.3 反馈处理模块

**功能描述：**
- 收集客户对推荐产品的反馈
- 将反馈转化为训练样本
- 统计分析样本数据
- 计算准确率提升

**反馈类型：**
- `interested`：感兴趣（正样本）
- `not_interested`：不感兴趣（负样本）
- `already_have`：已拥有（负样本）

### 5.4 事件分析模块

**功能描述：**
- 查询客户历史事件记录
- 统计分析事件类型分布
- 识别客户行为模式
- 评估客户活跃度

**事件类型：**
- A类事件：开户
- B类事件：激活
- D类事件：销户

### 5.5 新产品分析模块

**功能描述：**
- 新产品信息录入
- 产品冲突检测
- 目标客户匹配
- 收益预测分析

**冲突检测规则：**
1. 功能重叠检测：同类产品风险等级相似度
2. 客户竞争检测：投资门槛重叠度
3. 市场风险检测：产品定位冲突

---

## 6. 数据库设计

### 6.1 客户数据表(cust_dataset)

| 字段名 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| cust_no | String | 客户编号(主键) | CDB91DCCE198B10A522FE2AABF6A8D81 |
| birth_ym | String | 出生年月 | 194203 |
| age | Integer | 年龄 | 82 |
| loc_cd | String | 地区代码 | L001 |
| gender | String | 性别 | M/F |
| edu_bg | String | 教育背景 | 高中/大专/本科/硕士/博士 |
| marriage_situ_cd | String | 婚姻状况 | 未婚/已婚/离异/丧偶 |
| init_dt | Date | 开户日期 | 2011-03-01 |

### 6.2 事件数据表(event_dataset)

| 字段名 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| cust_no | String | 客户编号(外键) | CDB91DCCE198B10A522FE2AABF6A8D81 |
| prod_id | String | 产品编号 | C0001 |
| event_id | String | 事件编号 | E0001 |
| event_type | String | 事件类型 | A/B/D |
| event_level | String | 事件级别 | A/B/C |
| event_date | Date | 事件日期 | 2024-01-15 |
| event_term | Integer | 期限(天) | 365 |
| event_rate | Float | 利率 | 0.03 |
| event_amt | Float | 金额 | 50000.00 |

### 6.3 产品数据表(product_database)

| 字段名 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| id | String | 产品编号(主键) | SAVE_NEW_001 |
| name | String | 产品名称 | 大额存单 |
| category | String | 产品类别 | 储蓄类/信贷类/财富类/保障类 |
| riskLevel | Integer | 风险等级(1-4) | 1 |
| minAmount | Float | 最低投资额 | 200000 |
| features | Array | 产品特点 | ["保本","固定收益"] |

### 6.4 反馈样本表(customer_samples)

| 字段名 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| cust_no | String | 客户编号(外键) | CDB91DCCE198B10A522FE2AABF6A8D81 |
| productId | String | 产品编号 | SAVE_NEW_001 |
| productName | String | 产品名称 | 大额存单 |
| feedback | String | 反馈类型 | interested/not_interested/already_have |
| label | Integer | 样本标签 | 0/1 |
| timestamp | DateTime | 反馈时间 | 2024-01-15 10:30:00 |

---

## 7. 接口设计

### 7.1 接口规范

系统采用RESTful API设计规范，所有接口返回JSON格式数据。

**基础URL：** `http://localhost:3002`

**通用响应格式：**
```json
{
    "success": true,
    "message": "操作成功",
    "data": { ... }
}
```

**错误响应格式：**
```json
{
    "success": false,
    "error": "错误信息描述"
}
```

### 7.2 API接口列表

#### 7.2.1 健康检查

```
GET /api/health
```

**功能：** 检查系统运行状态

**响应示例：**
```json
{
    "status": "ok",
    "timestamp": "2024-12-15T10:30:00.000Z",
    "totalProducts": 17,
    "sampleCount": 0
}
```

#### 7.2.2 获取随机客户

```
GET /api/customers/random?count=10
```

**参数：**
- count：返回数量(可选，默认10)

**响应示例：**
```json
{
    "customers": [
        {
            "id": "A114ADFC907F29C34A8BA48281E4AD45",
            "description": "72岁男性-高净值"
        }
    ],
    "totalCustomers": 1108828
}
```

#### 7.2.3 获取客户信息

```
GET /api/customers/:custNo
```

**路径参数：**
- custNo：客户编号

**响应示例：**
```json
{
    "customer": {
        "cust_no": "CDB91DCCE198B10A522FE2AABF6A8D81",
        "age": 82,
        "gender": "M",
        "edu_bg": "本科",
        ...
    },
    "customerInsight": {
        "riskLevel": "低风险",
        "suitableCategories": ["储蓄类", "保障类"],
        "investmentCapacity": "高",
        "recommendation": "建议配置稳健型产品"
    },
    "recommendations": [ ... ],
    "events": [ ... ]
}
```

#### 7.2.4 提交反馈

```
POST /api/customers/:custNo/feedback
```

**请求体：**
```json
{
    "feedbacks": [
        {
            "productId": "SAVE_NEW_001",
            "feedback": "interested"
        }
    ]
}
```

**响应示例：**
```json
{
    "success": true,
    "message": "成功提交 1 条反馈",
    "samples": {
        "totalSamples": 1,
        "positiveSamples": 1,
        "negativeSamples": 0
    },
    "accuracyImprovement": "计算中..."
}
```

#### 7.2.5 获取优化推荐

```
GET /api/customers/:custNo/next-recommendations
```

**功能：** 基于反馈生成优化推荐（第二步推荐）

**响应示例：**
```json
{
    "customer": { ... },
    "recommendations": [
        {
            "id": "WEALTH_003",
            "name": "债券基金",
            "matchScore": 88,
            "improved": true
        }
    ]
}
```

#### 7.2.6 新产品分析

```
POST /api/products/new-product-analysis
```

**请求体：**
```json
{
    "newProduct": {
        "name": "智能稳健理财计划",
        "category": "理财",
        "riskLevel": 2,
        "minAmount": 50000
    }
}
```

**响应示例：**
```json
{
    "product": { ... },
    "analysis": {
        "conflicts": [ ... ],
        "targetCustomers": [ ... ],
        "revenue": { ... }
    }
}
```

#### 7.2.7 获取产品列表

```
GET /api/products
```

**响应示例：**
```json
{
    "products": [ ... ],
    "total": 17
}
```

---

## 8. 算法设计

### 8.1 推荐算法

系统采用基于规则的推荐算法，结合客户画像和产品属性进行匹配。

**算法流程：**

```
输入：客户信息C，产品数据库P
输出：推荐产品列表R

1. 初始化推荐列表 R = []

2. 对于产品数据库P中的每个产品p：
    2.1 检查风险等级匹配
        IF p.riskLevel > C.riskThreshold + 2 THEN
            CONTINUE
        END IF

    2.2 检查年龄匹配
        IF p.targetProfile.age存在 THEN
            IF C.age < minAge - 5 OR C.age > maxAge + 10 THEN
                CONTINUE
            END IF
        END IF

    2.3 检查投资金额匹配
        IF C.assets存在 AND p.minAmount > C.assets * 0.05 THEN
            CONTINUE
        END IF

    2.4 计算匹配分数 score
        score = 50  // 基础分

        // 年龄适配加分
        IF C.age >= 60 AND p.riskLevel <= 2 THEN
            score = score + 30
        ELSE IF C.age >= 40 AND p.riskLevel <= 3 THEN
            score = score + 20
        END IF

        // 风险偏好加分
        IF C.riskPreference == 'low' AND p.riskLevel <= 2 THEN
            score = score + 20
        ELSE IF C.riskPreference == 'high' AND p.riskLevel >= 3 THEN
            score = score + 20
        END IF

        // 其他因素加分...

        score = MIN(score, 100)

    2.5 将(p, score)加入R

3. 对R按score降序排序

4. 返回R的前5个产品
```

### 8.2 两步推荐策略

系统采用两步推荐策略持续优化推荐准确性：

**第一步：初始推荐**
- 基于客户基本信息和风险画像
- 生成初步推荐列表
- 收集客户反馈

**第二步：优化推荐**
- 分析客户历史反馈
- 识别客户偏好（类别、风险等级）
- 调整产品权重重新计算
- 生成优化后的推荐

**权重调整公式：**
```
调整后分数 = 原始分数 × 权重系数

权重系数计算：
IF 产品类别在偏好类别列表 THEN
    权重系数 = 1.5
ELSE IF 产品类别在避免类别列表 THEN
    权重系数 = 0.5
END IF

IF 产品风险等级 == 偏好风险等级 THEN
    权重系数 = 权重系数 × 1.3
END IF
```

### 8.3 冲突检测算法

```
输入：新产品NP，现有产品列表EP
输出：冲突列表CL

1. 初始化冲突列表 CL = []

2. 对于EP中的每个产品ep：
    2.1 检测功能重叠
        IF NP.category == ep.category THEN
            IF ABS(NP.riskLevel - ep.riskLevel) <= 1 THEN
                CL.ADD({
                    type: "功能重叠",
                    product: ep.name,
                    level: "high"
                })
            END IF
        END IF

    2.2 检测客户竞争
        IF NP.minAmount == ep.minAmount THEN
            CL.ADD({
                type: "客户竞争",
                product: ep.name,
                level: "medium"
            })
        END IF

3. 返回CL
```

---

## 9. 安全设计

### 9.1 数据安全

1. **客户隐私保护**
   - 敏感信息脱敏处理
   - 不存储客户密码等敏感数据

2. **数据传输安全**
   - 支持HTTPS加密传输
   - API接口采用Token认证

3. **数据访问控制**
   - 基于角色的访问控制
   - 操作日志记录

### 9.2 接口安全

1. **输入验证**
   - 所有输入参数进行格式校验
   - 防止SQL注入和XSS攻击

2. **访问频率限制**
   - 防止恶意请求
   - 接口调用频率控制

### 9.3 部署安全

1. **服务器配置**
   - 关闭不必要的端口
   - 定期更新系统补丁

2. **网络安全**
   - 防火墙配置
   - 入侵检测系统

---

## 10. 测试设计

### 10.1 测试类型

| 测试类型 | 测试内容 | 测试方法 |
|----------|----------|----------|
| 单元测试 | 各函数功能正确性 | 白盒测试 |
| 集成测试 | 模块间接口正确性 | 接口测试 |
| 功能测试 | 业务功能完整性 | 黑盒测试 |
| 性能测试 | 系统响应时间、并发能力 | 压力测试 |
| 兼容性测试 | 多浏览器、多设备兼容 | 兼容性测试 |

### 10.2 测试用例

#### 用例1：客户信息查询

| 测试项 | 输入 | 预期输出 |
|--------|------|----------|
| 正常客户 | 有效客户ID | 返回客户完整信息 |
| 不存在客户 | 无效客户ID | 返回错误提示 |
| 参数为空 | 空 | 返回参数错误提示 |

#### 用例2：产品推荐

| 测试项 | 输入 | 预期输出 |
|--------|------|----------|
| 正常推荐 | 有效客户ID | 返回3-5个推荐产品 |
| 高风险客户 | 高风险客户ID | 推荐高风险产品 |
| 低风险客户 | 低风险客户ID | 推荐低风险产品 |

#### 用例3：反馈提交

| 测试项 | 输入 | 预期输出 |
|--------|------|----------|
| 正常反馈 | 有效反馈数据 | 反馈保存成功 |
| 批量反馈 | 多条反馈数据 | 批量保存成功 |
| 重复反馈 | 相同产品多次反馈 | 更新原有反馈 |

### 10.3 性能指标

| 指标 | 目标值 |
|------|--------|
| 页面加载时间 | <2秒 |
| API响应时间 | <500ms |
| 推荐生成时间 | <200ms |
| 并发用户数 | >100 |
| 系统可用性 | >99.5% |

---

## 附录

### 附录A：产品类别说明

| 类别 | 风险等级 | 典型产品 |
|------|----------|----------|
| 储蓄类 | 1 | 大额存单、定期存款、教育储蓄、养老储蓄 |
| 信贷类 | 2-3 | 个人消费贷、住房按揭贷、企业经营贷 |
| 财富类 | 1-4 | 智能理财、股票基金、债券基金、混合基金、货币基金 |
| 保障类 | 1-2 | 人寿保险、重疾险、医疗险、意外险、年金保险 |

### 附录B：风险等级说明

| 等级 | 风险程度 | 适合人群 |
|------|----------|----------|
| 1 | 低风险 | 保守型投资者、老年人 |
| 2 | 中低风险 | 稳健型投资者 |
| 3 | 中高风险 | 平衡型投资者 |
| 4 | 高风险 | 激进型投资者、年轻人 |

### 附录C：版本历史

| 版本号 | 日期 | 说明 |
|--------|------|------|
| V1.0 | 2024-12-15 | 初始版本发布 |

---

**文档结束**
