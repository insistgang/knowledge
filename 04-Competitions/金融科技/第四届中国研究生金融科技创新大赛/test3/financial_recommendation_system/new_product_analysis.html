<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°äº§å“è¥é”€åˆ†æç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .main-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        /* äº§å“è¾“å…¥è¡¨å• */
        .product-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .form-group textarea {
            height: 80px;
            resize: vertical;
        }

        /* æ ‡ç­¾é¡µ */
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 12px 24px;
            background: #f0f0f0;
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: #1a73e8;
            color: white;
        }

        .tab-content {
            display: none;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .tab-content.active {
            display: block;
        }

        /* ç»“æœå±•ç¤º */
        .analysis-result {
            margin-top: 30px;
        }

        .result-card {
            background: white;
            padding: 25px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #1a73e8;
        }

        .result-card h3 {
            color: #1a73e8;
            margin-bottom: 15px;
        }

        /* å†²çªæ£€æµ‹ */
        .conflict-item {
            background: #fff3cd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
        }

        .conflict-high {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        .conflict-medium {
            background: #fff3cd;
            border-left-color: #ffc107;
        }

        .conflict-low {
            background: #d1ecf1;
            border-left-color: #17a2b8;
        }

        /* å®¢æˆ·ç»†åˆ† */
        .segment-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
        }

        .segment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .segment-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

        .segment-count {
            background: #1a73e8;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        /* æ”¶ç›Šä¼˜åŒ– */
        .strategy-item {
            background: #e7f3ff;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border: 1px solid #b3d9ff;
        }

        .strategy-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .strategy-title {
            font-size: 16px;
            font-weight: bold;
            color: #1a73e8;
        }

        .strategy-roi {
            background: #34a853;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
        }

        /* æŒ‰é’® */
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #1a73e8;
            color: white;
        }

        .btn-primary:hover {
            background: #1557b0;
        }

        .btn-success {
            background: #34a853;
            color: white;
        }

        .btn-success:hover {
            background: #2d8e47;
        }

        /* æ•°æ®è¡¨æ ¼ */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .data-table th {
            background: #f1f3f4;
            font-weight: bold;
        }

        /* ç»Ÿè®¡å¡ç‰‡ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
            border-top: 4px solid #1a73e8;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #1a73e8;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
        }

        /* é¢„å®šä¹‰äº§å“æ¨¡æ¿ */
        .product-templates {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .template-btn {
            padding: 8px 16px;
            background: #f1f3f4;
            border: 1px solid #ddd;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .template-btn:hover {
            background: #e8eaed;
            border-color: #1a73e8;
        }

        /* LoadingçŠ¶æ€ */
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #1a73e8;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="header">
            <h1>ğŸ¯ æ–°äº§å“è¥é”€åˆ†æç³»ç»Ÿ</h1>
            <p>åŸºäºäº§å“å±æ€§åˆ†æç›®æ ‡å®¢æˆ·ï¼Œæ£€æµ‹äº§å“å†²çªï¼Œä¼˜åŒ–æ”¶ç›Šç­–ç•¥</p>
        </div>

        <div class="content">
            <!-- äº§å“è¾“å…¥è¡¨å• -->
            <div class="product-form">
                <h2>ğŸ“ æ–°äº§å“ä¿¡æ¯</h2>

                <div class="product-templates">
                    <button class="template-btn" onclick="loadTemplate('savings')">ğŸ’° å‚¨è“„äº§å“</button>
                    <button class="template-btn" onclick="loadTemplate('wealth')">ğŸ“ˆ è´¢å¯Œç®¡ç†</button>
                    <button class="template-btn" onclick="loadTemplate('insurance')">ğŸ›¡ï¸ ä¿é™©äº§å“</button>
                    <button class="template-btn" onclick="loadTemplate('credit')">ğŸ’³ ä¿¡è´·äº§å“</button>
                    <button class="template-btn" onclick="clearForm()">ğŸ”„ æ¸…ç©º</button>
                </div>

                <form id="productForm" onsubmit="analyzeProduct(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="productName">äº§å“åç§° *</label>
                            <input type="text" id="productName" required placeholder="ä¾‹å¦‚ï¼šæ™ºèƒ½å­˜æ¬¾Plus">
                        </div>

                        <div class="form-group">
                            <label for="productId">äº§å“ID</label>
                            <input type="text" id="productId" placeholder="ä¾‹å¦‚ï¼šPROD_NEW_001">
                        </div>

                        <div class="form-group">
                            <label for="category">äº§å“ç±»åˆ« *</label>
                            <select id="category" required>
                                <option value="">è¯·é€‰æ‹©</option>
                                <option value="å‚¨è“„ç±»">å‚¨è“„ç±»</option>
                                <option value="è´¢å¯Œç±»">è´¢å¯Œç±»</option>
                                <option value="ä¿¡è´·ç±»">ä¿¡è´·ç±»</option>
                                <option value="ä¿éšœç±»">ä¿éšœç±»</option>
                                <option value="æ”¯ä»˜ç±»">æ”¯ä»˜ç±»</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="riskLevel">é£é™©ç­‰çº§ (1-4) *</label>
                            <select id="riskLevel" required>
                                <option value="1">1 - æä½é£é™©</option>
                                <option value="2">2 - ä½é£é™©</option>
                                <option value="3" selected>3 - ä¸­ç­‰é£é™©</option>
                                <option value="4">4 - é«˜é£é™©</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="minAmount">æœ€ä½æŠ•èµ„é‡‘é¢ (å…ƒ) *</label>
                            <input type="number" id="minAmount" required placeholder="10000" min="0">
                        </div>

                        <div class="form-group">
                            <label for="expectedReturn">é¢„æœŸå¹´åŒ–æ”¶ç›Šç‡</label>
                            <input type="number" id="expectedReturn" step="0.01" placeholder="0.05" min="0" max="1">
                        </div>

                        <div class="form-group">
                            <label for="targetAgeMin">ç›®æ ‡å¹´é¾„èŒƒå›´</label>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <input type="number" id="targetAgeMin" placeholder="25" min="0" max="100" style="flex: 1;">
                                <span>è‡³</span>
                                <input type="number" id="targetAgeMax" placeholder="65" min="0" max="100" style="flex: 1;">
                            </div>
                        </div>

                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label for="features">äº§å“ç‰¹å¾ (ç”¨é€—å·åˆ†éš”)</label>
                            <textarea id="features" placeholder="ä¾‹å¦‚ï¼šçµæ´»å­˜å–,é«˜æ”¶ç›Š,ä¿æœ¬ä¿æ¯,æ™ºèƒ½ç®¡ç†"></textarea>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary" style="font-size: 18px; padding: 15px 40px;">
                        ğŸ” å¼€å§‹åˆ†æ
                    </button>
                </form>
            </div>

            <!-- åˆ†æç»“æœ -->
            <div id="analysisResult" class="analysis-result" style="display: none;">
                <!-- æ ‡ç­¾é¡µ -->
                <div class="tabs">
                    <div class="tab active" onclick="showTab('overview')">ğŸ“Š åˆ†ææ¦‚è§ˆ</div>
                    <div class="tab" onclick="showTab('conflicts')">âš ï¸ å†²çªæ£€æµ‹</div>
                    <div class="tab" onclick="showTab('customers')">ğŸ‘¥ ç›®æ ‡å®¢æˆ·</div>
                    <div class="tab" onclick="showTab('revenue')">ğŸ’° æ”¶ç›Šä¼˜åŒ–</div>
                    <div class="tab" onclick="showTab('strategy')">ğŸ“‹ è¥é”€ç­–ç•¥</div>
                </div>

                <!-- æ¦‚è§ˆæ ‡ç­¾é¡µ -->
                <div id="overview" class="tab-content active">
                    <h3>ğŸ“Š äº§å“åˆ†ææ¦‚è§ˆ</h3>
                    <div id="overviewContent"></div>
                </div>

                <!-- å†²çªæ£€æµ‹æ ‡ç­¾é¡µ -->
                <div id="conflicts" class="tab-content">
                    <h3>âš ï¸ äº§å“å†²çªåˆ†æ</h3>
                    <div id="conflictsContent"></div>
                </div>

                <!-- ç›®æ ‡å®¢æˆ·æ ‡ç­¾é¡µ -->
                <div id="customers" class="tab-content">
                    <h3>ğŸ‘¥ ç›®æ ‡å®¢æˆ·åˆ†æ</h3>
                    <div id="customersContent"></div>
                </div>

                <!-- æ”¶ç›Šä¼˜åŒ–æ ‡ç­¾é¡µ -->
                <div id="revenue" class="tab-content">
                    <h3>ğŸ’° æ”¶ç›Šä¼˜åŒ–å»ºè®®</h3>
                    <div id="revenueContent"></div>
                </div>

                <!-- è¥é”€ç­–ç•¥æ ‡ç­¾é¡µ -->
                <div id="strategy" class="tab-content">
                    <h3>ğŸ“‹ è¥é”€ç­–ç•¥å»ºè®®</h3>
                    <div id="strategyContent"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3001/api';
        let analysisData = null;

        // åŠ è½½äº§å“æ¨¡æ¿
        function loadTemplate(type) {
            const templates = {
                savings: {
                    productName: 'æ™ºèƒ½å‚¨è“„Plus',
                    category: 'å‚¨è“„ç±»',
                    riskLevel: 1,
                    minAmount: 50000,
                    expectedReturn: 0.035,
                    targetAgeMin: 30,
                    targetAgeMax: 65,
                    features: 'çµæ´»å­˜å–,ä¿æœ¬ä¿æ¯,æ™ºèƒ½åˆ©ç‡,éšå­˜éšå–'
                },
                wealth: {
                    productName: 'ç¨³å¥ç†è´¢ä¼˜é€‰',
                    category: 'è´¢å¯Œç±»',
                    riskLevel: 3,
                    minAmount: 100000,
                    expectedReturn: 0.065,
                    targetAgeMin: 25,
                    targetAgeMax: 55,
                    features: 'ä¸“ä¸šç®¡ç†,åˆ†æ•£æŠ•èµ„,å®šæœŸè°ƒä»“,é£é™©æ§åˆ¶'
                },
                insurance: {
                    productName: 'ç»ˆèº«ä¿éšœè®¡åˆ’',
                    category: 'ä¿éšœç±»',
                    riskLevel: 1,
                    minAmount: 10000,
                    expectedReturn: 0.04,
                    targetAgeMin: 25,
                    targetAgeMax: 50,
                    features: 'ç»ˆèº«ä¿éšœ,ç°é‡‘ä»·å€¼,åˆ†çº¢å¢å€¼,ä¿è´¹è±å…'
                },
                credit: {
                    productName: 'å¿«é€Ÿæ¶ˆè´¹è´·',
                    category: 'ä¿¡è´·ç±»',
                    riskLevel: 2,
                    minAmount: 5000,
                    expectedReturn: 0.12,
                    targetAgeMin: 22,
                    targetAgeMax: 45,
                    features: 'å¿«é€Ÿå®¡æ‰¹,çµæ´»æœŸé™,ä½åˆ©ç‡,çº¿ä¸Šç”³è¯·'
                }
            };

            const template = templates[type];
            if (template) {
                document.getElementById('productName').value = template.productName;
                document.getElementById('category').value = template.category;
                document.getElementById('riskLevel').value = template.riskLevel;
                document.getElementById('minAmount').value = template.minAmount;
                document.getElementById('expectedReturn').value = template.expectedReturn;
                document.getElementById('targetAgeMin').value = template.targetAgeMin;
                document.getElementById('targetAgeMax').value = template.targetAgeMax;
                document.getElementById('features').value = template.features;
            }
        }

        // æ¸…ç©ºè¡¨å•
        function clearForm() {
            document.getElementById('productForm').reset();
        }

        // åˆ†æäº§å“
        async function analyzeProduct(event) {
            event.preventDefault();

            const btn = event.target.querySelector('button[type="submit"]');
            btn.disabled = true;
            btn.textContent = 'åˆ†æä¸­...';

            // æ”¶é›†è¡¨å•æ•°æ®
            const newProduct = {
                id: document.getElementById('productId').value || 'PROD_NEW_' + Date.now(),
                name: document.getElementById('productName').value,
                category: document.getElementById('category').value,
                riskLevel: parseInt(document.getElementById('riskLevel').value),
                minAmount: parseInt(document.getElementById('minAmount').value),
                expectedReturn: parseFloat(document.getElementById('expectedReturn').value) || 0,
                targetAgeRange: [
                    parseInt(document.getElementById('targetAgeMin').value) || 25,
                    parseInt(document.getElementById('targetAgeMax').value) || 65
                ],
                features: document.getElementById('features').value.split(',').map(f => f.trim()).filter(f => f)
            };

            try {
                const response = await fetch(`${API_BASE}/products/new-product-analysis`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ newProduct })
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                analysisData = await response.json();
                console.log('åˆ†æç»“æœ:', analysisData);

                // æ˜¾ç¤ºç»“æœ
                displayAnalysisResults();

                // æ˜¾ç¤ºåˆ†æç»“æœåŒºåŸŸ
                document.getElementById('analysisResult').style.display = 'block';

            } catch (error) {
                console.error('åˆ†æå¤±è´¥:', error);
                alert('åˆ†æå¤±è´¥: ' + error.message);
            } finally {
                btn.disabled = false;
                btn.textContent = 'ğŸ” å¼€å§‹åˆ†æ';
            }
        }

        // æ˜¾ç¤ºåˆ†æç»“æœ
        function displayAnalysisResults() {
            if (!analysisData) return;

            updateOverview();
            updateConflicts();
            updateCustomers();
            updateRevenue();
            updateStrategy();
        }

        // æ›´æ–°æ¦‚è§ˆ
        function updateOverview() {
            const content = document.getElementById('overviewContent');
            const product = analysisData.productInfo;
            const analysis = analysisData.analysis;

            let html = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${analysis.targetCustomerSegmentation.totalPotentialCustomers}</div>
                        <div class="stat-label">æ½œåœ¨ç›®æ ‡å®¢æˆ·</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${analysis.conflictDetection.conflicts.length}</div>
                        <div class="stat-label">äº§å“å†²çªæ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${analysis.targetCustomerSegmentation.penetrationRate}</div>
                        <div class="stat-label">å¸‚åœºæ¸—é€ç‡</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${(analysis.revenueOptimization.expectedROI * 100).toFixed(1)}%</div>
                        <div class="stat-label">é¢„æœŸROI</div>
                    </div>
                </div>

                <div class="result-card">
                    <h3>ğŸ“¦ äº§å“åŸºæœ¬ä¿¡æ¯</h3>
                    <table class="data-table">
                        <tr><th>äº§å“åç§°</th><td>${product.name}</td></tr>
                        <tr><th>äº§å“ç±»åˆ«</th><td>${product.category}</td></tr>
                        <tr><th>é£é™©ç­‰çº§</th><td>${product.riskLevel}/4</td></tr>
                        <tr><th>æœ€ä½é‡‘é¢</th><td>Â¥${product.minAmount.toLocaleString()}</td></tr>
                        <tr><th>é¢„æœŸæ”¶ç›Šç‡</th><td>${(product.expectedReturn * 100).toFixed(2)}%</td></tr>
                        <tr><th>ç›®æ ‡å¹´é¾„</th><td>${product.targetAgeRange[0]}-${product.targetAgeRange[1]}å²</td></tr>
                        <tr><th>äº§å“ç‰¹å¾</th><td>${product.features.join('ã€')}</td></tr>
                    </table>
                </div>

                <div class="result-card">
                    <h3>ğŸ¯ å¸‚åœºå®šä½</h3>
                    <p><strong>å®šä½ç­–ç•¥:</strong> ${analysis.marketPositioning}</p>
                    <p><strong>ç›®æ ‡å¸‚åœº:</strong> ${analysis.productAttributes.market.targetMarket}</p>
                    <p><strong>ç«äº‰ä¼˜åŠ¿:</strong> ${analysis.productAttributes.market.competitiveAdvantage}</p>
                    <p><strong>å·®å¼‚åŒ–ç¨‹åº¦:</strong> ${analysis.productAttributes.market.differentiation}</p>
                </div>

                <div class="result-card">
                    <h3>âš¡ äº§å“ç‰¹å¾åˆ†æ</h3>
                    <table class="data-table">
                        <tr><th>æµåŠ¨æ€§</th><td>${analysis.productAttributes.features.liquidity}</td></tr>
                        <tr><th>å¤æ‚åº¦</th><td>${analysis.productAttributes.features.complexity}</td></tr>
                        <tr><th>çµæ´»æ€§</th><td>${analysis.productAttributes.features.flexibility}</td></tr>
                        <tr><th>åˆ›æ–°æ€§</th><td>${analysis.productAttributes.features.innovation}</td></tr>
                    </table>
                </div>
            `;

            content.innerHTML = html;
        }

        // æ›´æ–°å†²çªæ£€æµ‹
        function updateConflicts() {
            const content = document.getElementById('conflictsContent');
            const conflicts = analysisData.analysis.conflictDetection;

            if (!conflicts.hasConflicts) {
                content.innerHTML = `
                    <div class="result-card" style="border-left-color: #34a853;">
                        <h3>âœ… æ— äº§å“å†²çª</h3>
                        <p>æ­å–œï¼æ–°äº§å“ä¸ç°æœ‰äº§å“æ— é‡å¤§å†²çªï¼Œå¯ä»¥æ­£å¸¸æ¨å‡ºã€‚</p>
                    </div>
                `;
                return;
            }

            let html = `
                <div class="result-card" style="border-left-color: #ffc107;">
                    <h3>âš ï¸ å‘ç° ${conflicts.conflicts.length} ä¸ªäº§å“å†²çª</h3>
                    <p><strong>æ•´ä½“ä¸¥é‡ç¨‹åº¦:</strong> ${conflicts.overallSeverity}</p>
                </div>
            `;

            conflicts.conflicts.forEach(conflict => {
                const severityClass = `conflict-${conflict.severity.toLowerCase()}`;
                html += `
                    <div class="conflict-item ${severityClass}">
                        <h4>å†²çªäº§å“: ${conflict.productName}</h4>
                        <p><strong>å†²çªç±»å‹:</strong> ${getConflictTypeText(conflict.conflictType)}</p>
                        <p><strong>ä¸¥é‡ç¨‹åº¦:</strong> ${conflict.severity}</p>
                        <p><strong>æè¿°:</strong> ${conflict.description}</p>
                        <p><strong>å½±å“:</strong> ${conflict.impact}</p>
                    </div>
                `;
            });

            if (conflicts.resolutions && conflicts.resolutions.length > 0) {
                html += `
                    <div class="result-card">
                        <h3>ğŸ› ï¸ è§£å†³æ–¹æ¡ˆå»ºè®®</h3>
                `;
                conflicts.resolutions.forEach(resolution => {
                    html += `
                        <div class="strategy-item">
                            <div class="strategy-header">
                                <span class="strategy-title">${getConflictTypeText(resolution.conflictType)}</span>
                                <span class="strategy-roi">æ½œåœ¨å½±å“: Â¥${(resolution.revenueImpact.potentialLoss || 0).toLocaleString()}</span>
                            </div>
                            <p><strong>çŸ­æœŸæ–¹æ¡ˆ:</strong> ${resolution.resolution.shortTerm}</p>
                            <p><strong>é•¿æœŸæ–¹æ¡ˆ:</strong> ${resolution.resolution.longTerm}</p>
                            <p><em>æ¢å¤æ—¶é—´: ${resolution.revenueImpact.recoveryTime} | å¯ç¼“è§£: ${resolution.revenueImpact.mitigationPotential}</em></p>
                        </div>
                    `;
                });
                html += '</div>';
            }

            content.innerHTML = html;
        }

        // æ›´æ–°ç›®æ ‡å®¢æˆ·
        function updateCustomers() {
            const content = document.getElementById('customersContent');
            const segmentation = analysisData.analysis.targetCustomerSegmentation;

            let html = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${segmentation.totalPotentialCustomers}</div>
                        <div class="stat-label">åŒ¹é…å®¢æˆ·æ€»æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${segmentation.segments.highValue.length}</div>
                        <div class="stat-label">é«˜å‡€å€¼å®¢æˆ·</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${segmentation.segments.youngProfessionals.length}</div>
                        <div class="stat-label">å¹´è½»ä¸“ä¸šäººå£«</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${segmentation.segments.retirees.length}</div>
                        <div class="stat-label">é€€ä¼‘äººç¾¤</div>
                    </div>
                </div>
            `;

            // å®¢æˆ·ç»†åˆ†å±•ç¤º
            html += '<h3 style="margin: 30px 0 20px 0;">ğŸ¯ å®¢æˆ·ç»†åˆ†å¸‚åœº</h3>';

            Object.entries(segmentation.segments).forEach(([segment, customers]) => {
                if (customers.length > 0) {
                    html += `
                        <div class="segment-card">
                            <div class="segment-header">
                                <span class="segment-title">${getSegmentName(segment)}</span>
                                <span class="segment-count">${customers.length}äºº</span>
                            </div>
                            <p>${getSegmentDescription(segment)}</p>
                        </div>
                    `;
                }
            });

            // æ˜¾ç¤ºå‰10ä¸ªåŒ¹é…å®¢æˆ·
            if (segmentation.matchedCustomers && segmentation.matchedCustomers.length > 0) {
                html += `
                    <div class="result-card">
                        <h3>ğŸ‘¥ é«˜åŒ¹é…åº¦å®¢æˆ· (å‰10å)</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>å®¢æˆ·ID</th>
                                    <th>åŒ¹é…åˆ†æ•°</th>
                                    <th>å®¢æˆ·ç»†åˆ†</th>
                                    <th>åŒ¹é…åŸå› </th>
                                </tr>
                            </thead>
                            <tbody>
                `;

                segmentation.matchedCustomers.slice(0, 10).forEach(customer => {
                    html += `
                        <tr>
                            <td>${customer.customerId}</td>
                            <td><strong>${customer.score.toFixed(1)}</strong></td>
                            <td>${getSegmentName(customer.segment)}</td>
                            <td>${customer.reasons.join('ã€')}</td>
                        </tr>
                    `;
                });

                html += '</tbody></table></div>';
            }

            content.innerHTML = html;
        }

        // æ›´æ–°æ”¶ç›Šä¼˜åŒ–
        function updateRevenue() {
            const content = document.getElementById('revenueContent');
            const revenueOpt = analysisData.analysis.revenueOptimization;
            const projection = revenueOpt.revenueProjection;

            let html = `
                <div class="result-card">
                    <h3>ğŸ’° ä¸‰å¹´æ”¶ç›Šé¢„æµ‹</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value">Â¥${projection.firstYear.toLocaleString()}</div>
                            <div class="stat-label">ç¬¬ä¸€å¹´æ”¶å…¥</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">Â¥${projection.secondYear.toLocaleString()}</div>
                            <div class="stat-label">ç¬¬äºŒå¹´æ”¶å…¥</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">Â¥${projection.thirdYear.toLocaleString()}</div>
                            <div class="stat-label">ç¬¬ä¸‰å¹´æ”¶å…¥</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">Â¥${projection.totalThreeYears.toLocaleString()}</div>
                            <div class="stat-label">ä¸‰å¹´æ€»æ”¶å…¥</div>
                        </div>
                    </div>
                </div>

                <h3 style="margin: 30px 0 20px 0;">ğŸ“ˆ æ”¶ç›Šä¼˜åŒ–ç­–ç•¥</h3>
            `;

            revenueOpt.primaryStrategies.forEach((strategy, index) => {
                html += `
                    <div class="strategy-item">
                        <div class="strategy-header">
                            <span class="strategy-title">${getStrategyTypeText(strategy.type)}</span>
                            <span class="strategy-roi">${strategy.expectedRevenueIncrease}</span>
                        </div>
                        <p><strong>ç­–ç•¥æè¿°:</strong> ${strategy.description}</p>
                        <p><strong>å®æ–½æ—¶é—´:</strong> ${strategy.implementationTimeframe}</p>
                        <p><strong>å…·ä½“æªæ–½:</strong></p>
                        <ul>
                            ${strategy.actions.map(action => `<li>${action}</li>`).join('')}
                        </ul>
                    </div>
                `;
            });

            content.innerHTML = html;
        }

        // æ›´æ–°è¥é”€ç­–ç•¥
        function updateStrategy() {
            const content = document.getElementById('strategyContent');
            const marketing = analysisData.recommendations.marketingStrategy;
            const launch = analysisData.recommendations.launchStrategy;

            let html = `
                <div class="result-card">
                    <h3>ğŸš€ äº§å“å‘å¸ƒç­–ç•¥</h3>
                    <p><strong>å‘å¸ƒé˜¶æ®µ:</strong> ${launch.phase}</p>
                    <p><strong>æ—¶é—´è§„åˆ’:</strong> ${launch.timeline}</p>
                    <p><strong>å®æ–½æ–¹æ³•:</strong> ${launch.approach}</p>
                </div>

                <h3 style="margin: 30px 0 20px 0;">ğŸ“‹ åˆ†å±‚è¥é”€ç­–ç•¥</h3>
            `;

            marketing.forEach((strategy, index) => {
                html += `
                    <div class="segment-card">
                        <div class="segment-header">
                            <span class="segment-title">${strategy.segment}</span>
                            <span class="segment-count">${strategy.channels.length}ä¸ªæ¸ é“</span>
                        </div>
                        <p><strong>è¥é”€æ–¹å¼:</strong> ${strategy.approach}</p>
                        <p><strong>æ¨å¹¿æ¸ é“:</strong> ${strategy.channels.join('ã€')}</p>
                        <p><strong>æ ¸å¿ƒä¿¡æ¯:</strong> ${strategy.messaging}</p>
                    </div>
                `;
            });

            content.innerHTML = html;
        }

        // è¾…åŠ©å‡½æ•°
        function getConflictTypeText(type) {
            const types = {
                'FUNCTIONAL_OVERLAP': 'åŠŸèƒ½é‡å ',
                'PRICE_COMPETITION': 'ä»·æ ¼ç«äº‰',
                'TARGET_CUSTOMER_OVERLAP': 'å®¢æˆ·é‡å ',
                'RISK_LEVEL_SIMILARITY': 'é£é™©ç­‰çº§ç›¸ä¼¼'
            };
            return types[type] || type;
        }

        function getSegmentName(segment) {
            const names = {
                'highValue': 'é«˜å‡€å€¼å®¢æˆ·',
                'massMarket': 'å¤§ä¼—å¸‚åœº',
                'youngProfessionals': 'å¹´è½»ä¸“ä¸šäººå£«',
                'retirees': 'é€€ä¼‘äººç¾¤',
                'riskAverse': 'é£é™©åŒæ¶å‹',
                'riskSeeking': 'é£é™©åå¥½å‹'
            };
            return names[segment] || segment;
        }

        function getSegmentDescription(segment) {
            const descriptions = {
                'highValue': 'èµ„äº§è¶…è¿‡100ä¸‡çš„å®¢æˆ·ï¼Œéœ€è¦ä¸ªæ€§åŒ–æœåŠ¡å’Œä¸“ä¸šç†è´¢å»ºè®®',
                'massMarket': 'æ™®é€šé›¶å”®å®¢æˆ·ï¼Œæ³¨é‡æ€§ä»·æ¯”å’Œä¾¿æ·æ€§',
                'youngProfessionals': '25-40å²çš„èŒåœºäººå£«ï¼Œåå¥½æ•°å­—åŒ–æœåŠ¡å’Œæˆé•¿å‹äº§å“',
                'retirees': '60å²ä»¥ä¸Šçš„é€€ä¼‘äººç¾¤ï¼Œé‡è§†ç¨³å¥æ”¶ç›Šå’Œå…»è€è§„åˆ’',
                'riskAverse': 'ä¿å®ˆå‹æŠ•èµ„è€…ï¼Œåå¥½ä½é£é™©ä¿æœ¬äº§å“',
                'riskSeeking': 'ç§¯æå‹æŠ•èµ„è€…ï¼Œæ„¿æ„æ‰¿æ‹…é£é™©è¿½æ±‚é«˜æ”¶ç›Š'
            };
            return descriptions[segment] || '';
        }

        function getStrategyTypeText(type) {
            const types = {
                'PRODUCT_DIFFERENTIATION': 'äº§å“å·®å¼‚åŒ–',
                'PRICING_STRATEGY': 'å®šä»·ç­–ç•¥',
                'PREMIUM_POSITIONING': 'é«˜ç«¯å®šä½',
                'CROSS_SELLING': 'äº¤å‰é”€å”®'
            };
            return types[type] || type;
        }

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function showTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // é¡µé¢åŠ è½½
        window.onload = function() {
            console.log('æ–°äº§å“è¥é”€åˆ†æç³»ç»Ÿå·²å°±ç»ª');
        };
    </script>
</body>
</html>