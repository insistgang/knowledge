# Day 6 架构图绘制执行清单

> 执行日期：2026-02-07
> 预计完成时间：90分钟
> 输出：4张架构图（PNG + PDF）

---

## 执行前准备 (5分钟)

### 工具准备

- [ ] 访问 https://app.diagrams.net/
- [ ] 创建新图：Blank Diagram
- [ ] 页面设置：1800×1200px，白色背景
- [ ] 创建文件夹保存输出

### 颜色模板准备

| 用途 | Hex | RGB |
|------|-----|-----|
| 输入输出 | #E5E7EB | (229, 231, 235) |
| 主蓝色 | #2563EB | (37, 99, 235) |
| 浅蓝色 | #DBEAFE | (219, 234, 254) |
| 主绿色 | #10B981 | (16, 185, 129) |
| 浅绿色 | #D1FAE5 | (209, 250, 229) |
| 主橙色 | #F59E0B | (245, 158, 11) |
| 浅黄色 | #FEF3C7 | (254, 243, 199) |
| 主粉色 | #EC4899 | (236, 72, 153) |
| 浅粉色 | #FCE7F3 | (252, 231, 243) |
| 边框灰色 | #374151 | (55, 65, 81) |

---

## Fig.1 整体系统框架 (30分钟)

### 组件清单

| 组件 | 位置 | 尺寸 | 颜色 | 文字 |
|------|------|------|------|------|
| 输入框 | x=600,y=50 | 600×60 | #E5E7EB | 输入图像 Input Image |
| Backbone框 | x=400,y=150 | 1000×200 | #DBEAFE | Backbone: CSPDarknet |
| C2f模块1 | x=420,y=190 | 100×80 | #FFFFFF | Stem |
| C2f模块2 | x=550,y=190 | 120×80 | #FFFFFF | C2f ×N |
| C2f模块3 | x=700,y=190 | 120×80 | #FFFFFF | C2f ×N |
| C2f模块4 | x=850,y=190 | 120×80 | #FFFFFF | C2f ×N |
| F2标签 | x=420,y=280 | 80×30 | - | F2(1/4) |
| F3标签 | x=550,y=280 | 80×30 | - | F3(1/8) |
| F4标签 | x=700,y=280 | 80×30 | - | F4(1/16) |
| F5标签 | x=850,y=280 | 90×30 | - | F5(1/32) |
| Neck框 | x=400,y=380 | 1000×250 | #D1FAE5 | Neck: AMSFF |
| P2模块 | x=450,y=450 | 150×100 | #FFFFFF | P2 (1/4) |
| P3模块 | x=630,y=450 | 150×100 | #FFFFFF | P3 (1/8) |
| P4模块 | x=810,y=450 | 150×100 | #FFFFFF | P4 (1/16) |
| P5模块 | x=990,y=450 | 150×100 | #FFFFFF | P5 (1/32) |
| Gate模块 | x=600,y=580 | 400×60 | #FEF3C7 | Gate Weights |
| Attention框 | x=400,y=680 | 1000×120 | #FEF3C7 | STAA |
| SA模块 | x=450,y=730 | 400×60 | #FFFFFF | Spatial Attention |
| TA模块 | x=870,y=730 | 400×60 | #FFFFFF | Channel Attention |
| Head框 | x=300,y=850 | 1200×200 | #FCE7F3 | Head: DCH |
| 分类分支 | x=350,y=920 | 500×150 | #DBEAFE | Classification |
| 回归分支 | x=950,y=920 | 500×150 | #D1FAE5 | Regression |
| 输出框 | x=600,y=1090 | 600×60 | #E5E7EB | 检测结果 |

### 连接箭头

- [ ] 输入 → Backbone (垂直向下)
- [ ] Backbone内4个C2f模块 (水平向右)
- [ ] F2-F5 → P2-P5 (垂直向下)
- [ ] P2↔P3↔P4↔P5 (双向水平)
- [ ] Neck → Attention (垂直向下)
- [ ] Attention → Head (垂直向下分叉)
- [ ] 分类分支和回归分支 → 输出 (合并向下)

### 图注准备

```
图1 本文提出的井盖状态检测系统整体框架。该系统包含四个主要组件：
(a) CSPDarknet主干网络，提取多尺度特征{F2, F3, F4, F5}；
(b) 自适应多尺度特征融合模块(AMSFF)，通过门控权重实现跨层级信息聚合；
(c) 时空感知注意力机制(STAA)，结合空间注意力和通道注意力增强特征表达；
(d) 解耦检测头(DCH)，分类分支预测7类状态，回归分支预测边界框坐标。

Fig. 1 Overall architecture of the proposed manhole cover status detection system.
```

### 导出检查

- [ ] 文件名：Fig_1_整体系统框架.png
- [ ] 分辨率：300 dpi
- [ ] 文件名：Fig_1_整体系统框架.pdf
- [ ] PDF矢量格式

---

## Fig.2 AMSFF模块 (20分钟)

### 组件清单

| 组件 | 尺寸 | 颜色 | 文字 |
|------|------|------|------|
| 输入标签 | 400×40 | #E5E7EB | {F2, F3, F4, F5} |
| 上采样路径 | 200×200 | #DBEAFE | Upsample |
| 保持路径 | 200×200 | #D1FAE5 | Keep |
| 下采样路径 | 200×200 | #FCE7F3 | Downsample |
| Conv框 | 150×60 | #FFFFFF | 1×1 Conv |
| 拼接融合 | 300×80 | #FFFFFF | Concat |
| 门控网络 | 400×80 | #FEF3C7 | Gate Network |
| 加权融合 | 300×80 | #FFFFFF | Σ w_ij·F_j |
| 残差连接 | 200×60 | #D1FAE5 | + F_i |
| 输出标签 | 200×40 | #E5E7EB | F̃_i |

### 图注准备

```
图2 自适应多尺度特征融合模块(AMSFF)结构。该模块通过上采样、保持原尺寸
和下采样三种操作，将所有层级特征对齐到目标尺度。门控网络根据特征
内容自适应计算融合权重，最终通过残差连接保留原始特征信息。

Fig. 2 Structure of Adaptive Multi-Scale Feature Fusion (AMSFF) module.
```

### 导出检查

- [ ] 文件名：Fig_2_AMSFF模块.png/pdf
- [ ] 分辨率：300 dpi

---

## Fig.3 解耦检测头 (20分钟)

### 组件清单

| 组件 | 尺寸 | 颜色 | 文字 |
|------|------|------|------|
| 输入特征 | 300×50 | #E5E7EB | F_i^(att) |
| 1×1 Conv | 200×60 | #FFFFFF | 1×1 Conv |
| 分类分支框 | 400×300 | #DBEAFE | Classification |
| 回归分支框 | 400×300 | #D1FAE5 | Regression |
| Conv 3×3 | 150×50 | #FFFFFF | 3×3 Conv |
| Conv 1×1 | 150×50 | #FFFFFF | 1×1 Conv |
| Softmax | 120×50 | #FEF3C7 | Softmax |
| Sigmoid | 120×50 | #FEF3C7 | Sigmoid |
| 类别预测 | 150×50 | #E5E7EB | p_i (7类) |
| 边界框预测 | 150×50 | #E5E7EB | b_i (4维) |
| 对比框 | 800×200 | #F3F4F6 | 对比说明 |

### 对比框内容

```
传统耦合头:              解耦检测头:
  输入                      输入
   ↓                         ↓
 共享卷积    ←→         分类分支 + 回归分支
   ↓                         ↓
 分类+回归                  分类     回归
   ↓                         ↓         ↓
 输出                      输出

问题: 任务冲突            优势: 独立优化 (+1.9% AP)
```

### 图注准备

```
图3 解耦检测头(DCH)结构。与传统耦合头不同，DCH将分类和回归任务
完全分离，使用独立的参数θ_cls和θ_reg。分类分支预测7类井盖状态
的概率分布，回归分支预测边界框的4个坐标参数。

Fig. 3 Structure of Decoupled Detection Head (DCH).
```

### 导出检查

- [ ] 文件名：Fig_3_解耦检测头.png/pdf
- [ ] 分辨率：300 dpi

---

## Fig.4 动态标签分配 (15分钟)

### 组件清单

| 组件 | 尺寸 | 颜色 | 文字 |
|------|------|------|------|
| 输入集合 | 500×60 | #E5E7EB | P={p_1,...,p_n}, GT={gt_1,...,gt_m} |
| 步骤1框 | 400×80 | #DBEAFE | 步骤1: 计算IoU |
| 步骤2框 | 400×80 | #DBEAFE | 步骤2: Top-K选择 |
| 步骤3框 | 400×80 | #DBEAFE | 步骤3: 计算代价 |
| 步骤4框 | 400×80 | #DBEAFE | 步骤4: 最优传输 |
| 步骤5框 | 400×80 | #DBEAFE | 步骤5: 计算损失 |
| 公式框 | 350×200 | #FEF3C7 | 关键公式 |
| 正样本 | 200×60 | #D1FAE5 | P⁺ |
| 负样本 | 200×60 | #FEE2E2 | P⁻ |

### 公式框内容

```
匹配代价: C_ij = λ₁·L_cls + λ₂·L_IoU

最优传输:
  min  Σ T_ij · C_ij
   T
  s.t. Σ_j T_ij = 1
       Σ_i T_ij = k_j
```

### 图注准备

```
图4 基于最优传输的动态标签分配机制。该机制首先计算预测框与真值框
的IoU矩阵，然后根据IoU阈值动态确定每个真值的正样本数量k_j。
通过求解最优传输问题，为每个真值分配最优的正样本集合。

Fig. 4 Dynamic label assignment mechanism based on Optimal Transport.
```

### 导出检查

- [ ] 文件名：Fig_4_动态标签分配.png/pdf
- [ ] 分辨率：300 dpi

---

## 最终检查清单 (5分钟)

### 全局检查

- [ ] 4张图风格统一
- [ ] 颜色方案一致
- [ ] 字体大小统一
- [ ] 箭头样式一致
- [ ] 中英文双语完整

### 文件检查

- [ ] 8个文件全部生成（4 PNG + 4 PDF）
- [ ] 文件命名正确
- [ ] 文件大小合理（<1MB PNG, <500KB PDF）
- [ ] 保存位置正确

### 图注文档

- [ ] 图号连续（Fig.1-Fig.4）
- [ ] 图注描述充分
- [ ] 中英文对应

---

## 输出文件清单

完成后将获得以下文件：

```
E:\000\knowledge\Attachments\论文图表\
├── Fig_1_整体系统框架.png
├── Fig_1_整体系统框架.pdf
├── Fig_2_AMSFF模块.png
├── Fig_2_AMSFF模块.pdf
├── Fig_3_解耦检测头.png
├── Fig_3_解耦检测头.pdf
├── Fig_4_动态标签分配.png
└── Fig_4_动态标签分配.pdf
```

---

**执行人**: Academic Writer
**预计开始时间**: 2026-02-07 08:00
**预计完成时间**: 2026-02-07 09:30
**状态**: 准备就绪，等待执行
