# 论文架构图设计规范

> **论文**: 基于YOLOv11深度学习的智慧城市井盖状态检测系统
> **用途**: 第2章 方法部分的可视化图表设计
> **制定日期**: 2026-02-07

---

## 一、必需图表清单

### 1.1 方法部分图表（4张）

| 编号 | 图名 | 类型 | 位置 | 用途 |
|------|------|------|------|------|
| Fig.1 | 整体系统框架图 | 架构图 | 2.1节 | 展示端到端检测流程 |
| Fig.2 | 改进的多层次特征融合模块详细图 | 结构图 | 2.3节 | 展示AMSFF结构 |
| Fig.3 | 解耦检测头结构图 | 结构图 | 2.4节 | 展示DCH结构 |
| Fig.4 | 动态标签分配机制示意图 | 流程图 | 2.4节 | 展示TAL机制 |

### 1.2 实验部分图表（10张）

| 编号 | 图名 | 类型 | 位置 | 用途 |
|------|------|------|------|------|
| Fig.5 | 与SOTA方法的性能对比柱状图 | 柱状图 | 3.3节 | 对比实验结果 |
| Fig.6 | 混淆矩阵（7类状态） | 热力图 | 3.3节 | 各状态分类效果 |
| Fig.7 | PR曲线（各类别） | 曲线图 | 3.3节 | 精度-召回性能 |
| Fig.8 | 检测结果示例（成功案例） | 示例图 | 3.3节 | 多场景检测结果 |
| Fig.9 | 失败案例分析 | 示例图 | 3.3节 | 典型失败案例 |
| Fig.10 | 特征可视化（t-SNE） | 散点图 | 3.4节 | 特征可分性 |
| Fig.11 | 消融实验对比 | 柱状图 | 3.4节 | 各模块贡献 |
| Table 1 | 与主流方法性能对比 | 表格 | 3.3节 | 数值对比 |
| Table 2 | 各类状态检测精度 | 表格 | 3.3节 | 细粒度分析 |
| Table 3 | 消融实验结果 | 表格 | 3.4节 | 逐步消融 |

---

## 二、架构图详细设计

### 2.1 Fig.1 整体系统框架图

#### 布局结构

```
┌─────────────────────────────────────────────────────────────────┐
│                      输入图像 I (640×640×3)                      │
└─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────┐
│                         Backbone (CSPDarknet)                    │
│  ┌─────┐    ┌─────┐    ┌─────┐    ┌─────┐                       │
│  │ C1  │ →  │ C2  │ →  │ C3  │ →  │ C4  │ → ...                 │
│  └─────┘    └─────┘    └─────┘    └─────┘                       │
└─────────────────────────────────────────────────────────────────┘
      │           │           │           │
      ▼           ▼           ▼           ▼
    ┌───┐       ┌───┐       ┌───┐       ┌───┐
    │ P2│       │ P3│       │ P4│       │ P5│  ← 多尺度特征
    └───┘       └───┘       └───┘       └───┘
      │           │           │           │
      └───────────┴───────────┴───────────┘
                    │
                    ▼
┌─────────────────────────────────────────────────────────────────┐
│            Neck: 自适应多尺度特征融合 (AMSFF)                     │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  P2 ←→ P3 ←→ P4 ←→ P5  (双向融合 + 门控权重)            │   │
│  └─────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                    │
                    ▼
┌─────────────────────────────────────────────────────────────────┐
│           时空感知注意力 (STAA)                                   │
│  ┌──────────────────┐       ┌──────────────────┐               │
│  │   空间注意力(SA)  │   ×   │   通道注意力(TA)  │               │
│  └──────────────────┘       └──────────────────┘               │
└─────────────────────────────────────────────────────────────────┘
                    │
                    ▼
┌─────────────────────────────────────────────────────────────────┐
│              Head: 解耦检测头 (DCH)                               │
│  ┌─────────────────┐         ┌─────────────────┐                │
│  │  分类分支        │         │  回归分支        │                │
│  │  (7类状态)       │         │  (边界框)        │                │
│  └─────────────────┘         └─────────────────┘                │
└─────────────────────────────────────────────────────────────────┘
                    │
                    ▼
┌─────────────────────────────────────────────────────────────────┐
│         NMS后处理 → 检测结果 (类别, 置信度, 坐标)                   │
└─────────────────────────────────────────────────────────────────┘
```

#### 颜色规范

| 组件类型 | 颜色 | RGB | 说明 |
|---------|------|-----|------|
| 输入输出 | 浅灰 | (220, 220, 220) | 数据流 |
| Backbone | 浅蓝 | (173, 216, 230) | 特征提取 |
| Neck | 浅绿 | (144, 238, 144) | 特征融合 |
| 注意力 | 浅黄 | (255, 255, 224) | 注意力模块 |
| Head | 浅红 | (255, 182, 193) | 检测头 |

#### 字体规范

| 元素 | 字体 | 大小 |
|------|------|------|
| 标题 | 黑体 | 18pt |
| 模块名称 | 黑体 | 12pt |
| 内部说明 | 宋体 | 10pt |
| 箭头标注 | Arial | 9pt |

### 2.2 Fig.2 改进的AMSFF模块

#### 布局结构

```
                    输入特征 {F2, F3, F4, F5}
                            │
        ┌───────────────────┼───────────────────┐
        │                   │                   │
        ▼                   ▼                   ▼
   ┌─────────┐        ┌─────────┐        ┌─────────┐
   │ 上采样   │        │  保持    │        │ 下采样   │
   │ Upsample │        │  Keep   │        │ Downsample│
   └─────────┘        └─────────┘        └─────────┘
        │                   │                   │
        ▼                   ▼                   ▼
   ┌─────────┐        ┌─────────┐        ┌─────────┐
   │ 1×1 Conv │       │ 1×1 Conv │       │ 1×1 Conv │
   └─────────┘        └─────────┘        └─────────┘
        │                   │                   │
        └───────────────────┼───────────────────┘
                            │
                            ▼
                    ┌──────────────┐
                    │  门控融合     │
                    │  w_i = σ(g_i) │
                    └──────────────┘
                            │
                            ▼
                    ┌──────────────┐
                    │  残差连接     │
                    │  + F_i        │
                    └──────────────┘
                            │
                            ▼
                    输出特征 F̃_i
```

#### 核心标注

- **上采样路径**: 使用双线性插值或转置卷积
- **下采样路径**: 使用步长为2的3×3卷积
- **门控机制**: 使用1×1卷积生成权重，Sigmoid激活
- **残差连接**: 保留原始特征信息

### 2.3 Fig.3 解耦检测头结构

#### 布局结构

```
                    输入特征 F_i
                        │
                        ▼
                 ┌──────────────┐
                 │   1×1 Conv   │
                 └──────────────┘
                        │
            ┌───────────┴───────────┐
            │                       │
            ▼                       ▼
    ┌───────────────┐       ┌───────────────┐
    │  分类分支      │       │  回归分支      │
    └───────────────┘       └───────────────┘
            │                       │
            ▼                       ▼
    ┌───────────────┐       ┌───────────────┐
    │  3×3 Conv ×2  │       │  3×3 Conv ×2  │
    └───────────────┘       └───────────────┘
            │                       │
            ▼                       ▼
    ┌───────────────┐       ┌───────────────┐
    │  1×1 Conv     │       │  1×1 Conv     │
    └───────────────┘       └───────────────┘
            │                       │
            ▼                       ▼
    ┌───────────────┐       ┌───────────────┐
    │  Softmax      │       │  Sigmoid      │
    │  (7类概率)     │       │  (4个坐标)     │
    └───────────────┘       └───────────────┘
            │                       │
            ▼                       ▼
      类别预测 p_i              边界框 b_i
```

#### 关键差异标注

对比传统耦合头：
```
传统耦合头:
输入 → 共享卷积 → 分类输出 + 回归输出

解耦检测头:
输入 → 分类分支(独立参数) → 分类输出
    → 回归分支(独立参数) → 回归输出
```

### 2.4 Fig.4 动态标签分配机制

#### 流程图结构

```
        预测框集合 P = {p_1, p_2, ..., p_n}
                        │
                        ▼
              ┌─────────────────┐
              │ 计算与GT的IoU    │
              │ IoU_i = IoU(p_i, gt) │
              └─────────────────┘
                        │
                        ▼
              ┌─────────────────┐
              │ Top-K选择       │
              │ k = sum(IoU > 0.5)│
              └─────────────────┘
                        │
                        ▼
              ┌─────────────────┐
              │ 计算代价矩阵     │
              │ C_ij = IoU_loss  │
              └─────────────────┐
                        │
                        ▼
              ┌─────────────────┐
              │ 最优传输求解     │
              │ 动态分配正样本   │
              └─────────────────┘
                        │
                        ▼
                正样本集合 P^+
```

---

## 三、实验图表设计

### 3.1 Fig.5 SOTA对比柱状图

#### 数据布局

| 方法 | mAP@0.5 | Precision | Recall | FPS |
|------|---------|-----------|--------|-----|
| Faster R-CNN | 85.3 | 87.2 | 82.1 | 12.5 |
| YOLOv5s | 88.7 | 89.5 | 86.3 | 45.2 |
| YOLOv8n | 90.4 | 91.2 | 88.7 | 38.6 |
| YOLOv11n | 91.6 | 92.3 | 89.8 | 42.5 |
| **本文方法** | **93.2** | **94.1** | **91.5** | **40.8** |

#### 可视化规范

- 使用分组柱状图
- Y轴：0-100%
- 突出显示本文方法（使用对比色）
- 添加误差棒（如果有多次实验）

### 3.2 Fig.6 混淆矩阵

#### 布局

```
              预测类别
          完  破  缺  移  凹  遮  被
          整  损  失  位  陷  挡  占
      完  ████    2    1    0    0    0    1
真  破    3  ████    0    0    2    1    0
实  缺    1    0  ████    0    0    0    0
类  移    0    1    0  ████    0    2    1
别  凹    0    2    0    0  ████    0    0
    遮    0    1    0    1    0  ████    2
    被    1    0    0    1    0    1  ████
```

#### 颜色映射

- 对角线（正确）：深绿色
- 非对角线（错误）：白色到浅红色渐变

### 3.3 Fig.7 PR曲线

#### 布局

- X轴：Recall (0-1)
- Y轴：Precision (0-1)
- 7条曲线对应7个类别
- 添加AP值标注

### 3.4 Fig.8 检测结果示例

#### 场景选择

1. 正常井盖（多场景：晴天/雨天/夜晚）
2. 破损井盖（不同破损程度）
3. 缺失井盖（空洞明显）
4. 被占井盖（车辆/货物遮挡）
5. 阴影/复杂背景场景

#### 标注格式

```
[类别] 置信度%
┌─────────┐
│         │
│  井盖   │ 94.2%
│         │
└─────────┘
```

---

## 四、制作工具与规范

### 4.1 推荐工具

| 工具 | 用途 | 优势 |
|------|------|------|
| **draw.io** | 架构图 | 免费、在线、导出高清 |
| **Python (matplotlib)** | 数据图表 | 自动化、可复现 |
| **PowerPoint** | 示例图 | 易标注、组合灵活 |
| **Visio** | 流程图 | 专业、模板丰富 |

### 4.2 导出规范

| 参数 | 值 | 说明 |
|------|---|------|
| 分辨率 | ≥300 dpi | 满足期刊要求 |
| 格式 | PNG/PDF | 无损压缩 |
| 宽度 | 16cm (单栏) / 12cm (双栏) | 适配版面 |
| 字体 | 嵌入字体 | 避免字体缺失 |

### 4.3 色盲友好配色

```python
# 推荐配色方案（色盲友好）
colors = {
    'blue': '#0072B2',
    'orange': '#D55E00',
    'green': '#009E73',
    'yellow': '#F0E442',
    'dark_blue': '#56B4E9',
    'red': '#CC79A7',
    'purple': '#949494'
}
```

---

## 五、图注与引用规范

### 5.1 图注格式

```
图1 本文提出的井盖状态检测系统整体框架。该系统包含四个主要组件：
(a) CSPDarknet主干网络，用于多尺度特征提取；
(b) 自适应多尺度特征融合模块(AMSFF)，用于跨层级信息聚合；
(c) 时空感知注意力机制(STAA)，用于增强特征表达能力；
(d) 解耦检测头(DCH)，用于独立预测类别和位置。
```

### 5.2 表格格式

```markdown
**表1 与主流目标检测方法的性能对比**

| 方法 | Backbone | mAP@0.5(%) | Precision(%) | Recall(%) | FPS |
|------|----------|------------|--------------|-----------|-----|
| Faster R-CNN | ResNet-50 | 85.3 | 87.2 | 82.1 | 12.5 |
| YOLOv5s | CSPDarknet | 88.7 | 89.5 | 86.3 | 45.2 |
| ... | ... | ... | ... | ... | ... |
| **本文方法** | **改进YOLOv11** | **93.2** | **94.1** | **91.5** | **40.8** |

*注：粗体表示最优结果，FPS在RTX 3080 GPU上测试。*
```

---

## 六、检查清单

### 架构图检查

- [ ] 所有模块标注清晰
- [ ] 数据流向用箭头明确指示
- [ ] 颜色搭配符合色盲友好标准
- [ ] 字体大小适中（不小于9pt）
- [ ] 导出分辨率≥300dpi

### 数据图表检查

- [ ] 坐标轴标注完整（含单位）
- [ ] 图例清晰可辨
- [ ] 数据来源标注
- [ ] 误差棒（如有）清晰可见
- [ ] 多次实验结果标注

### 整体检查

- [ ] 图表编号连续
- [ ] 图注描述充分
- [ ] 中英文双语标注
- [ ] 引用位置正确
- [ ] 与正文内容一致

---

*文档版本: v1.0*
*最后更新: 2026-02-07*
*维护者: Technical Architect*
